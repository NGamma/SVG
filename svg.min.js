/* SVG (c) Robby Kraft, MIT License */
(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.SVG={})})(this,function(a){"use strict";var g=Math.sin,h=Math.cos;function b(a){var b="    ";isNaN(parseInt(a))?b=a:1===a?b=" ":2===a?b="  ":3===a?b="   ":4===a?b="    ":5===a?b="     ":6===a?b="      ":7===a?b="       ":8===a?b="        ":9===a?b="         ":10===a?b="          ":11===a?b="           ":12===a?b="            ":void 0;var c=["\n"];for(let d=0;100>d;d++)c.push(c[d]+b);return c}function c(){this.step="\t",this.shift=b(this.step)}function d(a,b){return b-(a.replace(/\(/g,"").length-a.replace(/\)/g,"").length)}function e(a,b){return a.replace(/\s{1,}/g," ").replace(/ AND /ig,"~::~"+b+b+"AND ").replace(/ BETWEEN /ig,"~::~"+b+"BETWEEN ").replace(/ CASE /ig,"~::~"+b+"CASE ").replace(/ ELSE /ig,"~::~"+b+"ELSE ").replace(/ END /ig,"~::~"+b+"END ").replace(/ FROM /ig,"~::~FROM ").replace(/ GROUP\s{1,}BY/ig,"~::~GROUP BY ").replace(/ HAVING /ig,"~::~HAVING ").replace(/ IN /ig," IN ").replace(/ JOIN /ig,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /ig,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /ig,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /ig,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /ig,"~::~RIGHT JOIN ").replace(/ ON /ig,"~::~"+b+"ON ").replace(/ OR /ig,"~::~"+b+b+"OR ").replace(/ ORDER\s{1,}BY/ig,"~::~ORDER BY ").replace(/ OVER /ig,"~::~"+b+"OVER ").replace(/\(\s{0,}SELECT /ig,"~::~(SELECT ").replace(/\)\s{0,}SELECT /ig,")~::~SELECT ").replace(/ THEN /ig," THEN~::~"+b+"").replace(/ UNION /ig,"~::~UNION~::~").replace(/ USING /ig,"~::~USING ").replace(/ WHEN /ig,"~::~"+b+"WHEN ").replace(/ WHERE /ig,"~::~WHERE ").replace(/ WITH /ig,"~::~WITH ").replace(/ ALL /ig," ALL ").replace(/ AS /ig," AS ").replace(/ ASC /ig," ASC ").replace(/ DESC /ig," DESC ").replace(/ DISTINCT /ig," DISTINCT ").replace(/ EXISTS /ig," EXISTS ").replace(/ NOT /ig," NOT ").replace(/ NULL /ig," NULL ").replace(/ LIKE /ig," LIKE ").replace(/\s{0,}SELECT /ig,"SELECT ").replace(/\s{0,}UPDATE /ig,"UPDATE ").replace(/ SET /ig," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}function f(a){let b,c=W(a),d={};const e=function(a,b){if(null==b)return;0<b.length&&a.preventDefault();let d=c.getPointer();b.forEach(a=>a(d))},f=function(a){let b=d[V.end];c.didRelease(a.clientX,a.clientY),e(a,b)},g=function(a){let c=d[V.scroll],g={deltaX:a.deltaX,deltaY:a.deltaY,deltaZ:a.deltaZ};g.position=y(b,a.clientX,a.clientY),g.x=g.position[0],g.y=g.position[1],null==c||(0<c.length&&a.preventDefault(),c.forEach(a=>a(g)))};let h,i,j;const k=function(a){null!=h&&clearInterval(i),h=a,null!=h&&(j=0,i=setInterval(()=>{let a={time:b.getCurrentTime(),frame:j++};h(a)},1e3/60))},l={mouseup:f,mousedown:function(a){let b=d[V.begin];c.didPress(a.clientX,a.clientY),e(a,b)},mousemove:function(a){let b=d[V.move];c.didMove(a.clientX,a.clientY),e(a,b)},mouseleave:function(a){let b=d[V.leave];c.didMove(a.clientX,a.clientY),e(a,b)},mouseenter:function(a){let b=d[V.enter];c.didMove(a.clientX,a.clientY),e(a,b)},touchend:f,touchmove:function(a){let b=d[V.move],f=a.touches[0];null==f||(c.didMove(f.clientX,f.clientY),e(a,b))},touchstart:function(a){let b=d[V.begin],f=a.touches[0];null==f||(c.didPress(f.clientX,f.clientY),e(a,b))},touchcancel:f,wheel:g},m=function(a,b){if("function"!=typeof b)throw"must supply a function type to addEventListener";void 0===d[a]&&(d[a]=[]),d[a].push(b)},n=function(a){Object.keys(l).forEach(b=>a.addEventListener(b,l[b],!1)),k(h)},o=function(a){Object.keys(l).forEach(b=>a.removeEventListener(b,l[b],!1)),null!=h&&clearInterval(i)},p=function(a){null!=b&&o(b),b=a,c.node=b,Object.keys(V).map(a=>V[a]).forEach(a=>{Object.defineProperty(b,a,{set:function(b){m(a,b)}})}),Object.defineProperty(b,"animate",{set:function(a){k(a)}}),Object.defineProperty(b,"mouse",{get:function(){return c.getPointer()}}),Object.defineProperty(b,"pointer",{get:function(){return c.getPointer()}}),n(b)};return p(a),{setup:p,remove:function(){o(b)}}}c.prototype.xml=function(a,c){var d=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),e=d.length,f=!1,g=0,h="",i=c?b(c):this.shift;for(let b=0;b<e;b++)-1<d[b].search(/<!/)?(h+=i[g]+d[b],f=!0,(-1<d[b].search(/-->/)||-1<d[b].search(/\]>/)||-1<d[b].search(/!DOCTYPE/))&&(f=!1)):-1<d[b].search(/-->/)||-1<d[b].search(/\]>/)?(h+=d[b],f=!1):/^<\w/.exec(d[b-1])&&/^<\/\w/.exec(d[b])&&/^<[\w:\-\.\,]+/.exec(d[b-1])==/^<\/[\w:\-\.\,]+/.exec(d[b])[0].replace("/","")?(h+=d[b],f||g--):-1<d[b].search(/<\w/)&&-1==d[b].search(/<\//)&&-1==d[b].search(/\/>/)?h=f?h+=d[b]:h+=i[g++]+d[b]:-1<d[b].search(/<\w/)&&-1<d[b].search(/<\//)?h=f?h+=d[b]:h+=i[g]+d[b]:-1<d[b].search(/<\//)?h=f?h+=d[b]:h+=i[--g]+d[b]:-1<d[b].search(/\/>/)?h=f?h+=d[b]:h+=i[g]+d[b]:h+=-1<d[b].search(/<\?/)?i[g]+d[b]:-1<d[b].search(/xmlns\:/)||-1<d[b].search(/xmlns\=/)?i[g]+d[b]:d[b];return"\n"==h[0]?h.slice(1):h},c.prototype.json=function(a,b){var b=b?b:this.step;return"undefined"==typeof JSON?a:"string"==typeof a?JSON.stringify(JSON.parse(a),null,b):"object"==typeof a?JSON.stringify(a,null,b):a},c.prototype.css=function(a,c){var d=a.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),e=d.length,f=0,g="",h=c?b(c):this.shift;for(let b=0;b<e;b++)g+=/\{/.exec(d[b])?h[f++]+d[b]:/\}/.exec(d[b])?h[--f]+d[b]:/\*\\/.exec(d[b])?h[f]+d[b]:h[f]+d[b];return g.replace(/^\n{1,}/,"")},c.prototype.sql=function(a,c){var f=a.replace(/\s{1,}/g," ").replace(/\'/ig,"~::~'").split("~::~"),g=f.length,h=[],i=0,j=this.step,k=0,l="",m=c?b(c):this.shift;for(let b=0;b<g;b++)h=b%2?h.concat(f[b]):h.concat(e(f[b],j));g=h.length;for(let b=0;b<g;b++)k=d(h[b],k),/\s{0,}\s{0,}SELECT\s{0,}/.exec(h[b])&&(h[b]=h[b].replace(/\,/g,",\n"+j+j+"")),/\s{0,}\s{0,}SET\s{0,}/.exec(h[b])&&(h[b]=h[b].replace(/\,/g,",\n"+j+j+"")),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(h[b])?(i++,l+=m[i]+h[b]):/\'/.exec(h[b])?(1>k&&i&&i--,l+=h[b]):(l+=m[i]+h[b],1>k&&i&&i--);return l=l.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n"),l},c.prototype.xmlmin=function(a,b){var c=b?a:a.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return c.replace(/>\s{0,}</g,"><")},c.prototype.jsonmin=function(a){return"undefined"==typeof JSON?a:JSON.stringify(JSON.parse(a),null,0)},c.prototype.cssmin=function(a,b){var c=b?a:a.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"");return c.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},c.prototype.sqlmin=function(a){return a.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")};var i=new c;const j=function(a){for(;a.lastChild;)a.removeChild(a.lastChild)},k=function(a){let b=parseInt(a.getAttributeNS(null,"width"));return null==b||isNaN(b)?a.getBoundingClientRect().width:b},l=function(a){let b=parseInt(a.getAttributeNS(null,"height"));return null==b||isNaN(b)?a.getBoundingClientRect().height:b},m=function(a){let b=a.getAttribute("class");return null==b?[]:b.split(" ").filter(a=>""!==a)},n=function(a,b){if(null!=a){let c=m(a).filter(a=>a!==b);return c.push(b),a.setAttributeNS(null,"class",c.join(" ")),a}},o=function(a,b){if(null!=a){let c=m(a).filter(a=>a!==b);return a.setAttributeNS(null,"class",c.join(" ")),a}},p=function(a,b){return a.setAttributeNS(null,"class",b),a},q=function(a,b){return a.setAttributeNS(null,"id",b),a},r=function(b,c="image.svg"){let d=document.createElement("a"),a=new window.XMLSerializer().serializeToString(b),e=i.xml(a),f=new window.Blob([e],{type:"text/plain"});d.setAttribute("href",window.URL.createObjectURL(f)),d.setAttribute("download",c),document.body.appendChild(d),d.click(),d.remove()},s=new window.DOMParser().parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI,t=function(a,b){if("string"==typeof a||a instanceof String){let c=new window.DOMParser().parseFromString(a,"text/xml");if(0===c.getElementsByTagNameNS(s,"parsererror").length){let a=c.documentElement;return null!=b&&b(a),a}fetch(a).then(a=>a.text()).then(a=>new window.DOMParser().parseFromString(a,"text/xml")).then(a=>{let c=a.getElementsByTagName("svg");if(null==c||0===c.length)throw"error, valid XML found, but no SVG element";return null!=b&&b(c[0]),c[0]})}else if(a instanceof Document)return b(a),a},u=function(a,b,c,e,f,g=0){let h=e/1-e,d=[b-h-g,c-h-g,e+2*h+2*g,f+2*h+2*g].join(" ");a.setAttributeNS(null,"viewBox",d)},v=function(a){let b=a.getAttribute("viewBox");return null==b?void 0:b.split(" ").map(a=>parseFloat(a))},w=function(a,b,c=0,d=0){1e-8>b&&(b=.01);let e=a.createSVGMatrix().translate(c,d).scale(1/b).translate(-c,-d),f=v(a);null==f&&z(a);let g=a.createSVGPoint(),h=a.createSVGPoint();g.x=f[0],g.y=f[1],h.x=f[0]+f[2],h.y=f[1]+f[3];let i=g.matrixTransform(e),j=h.matrixTransform(e);u(a,i.x,i.y,j.x-i.x,j.y-i.y)},x=function(a,b,c){let d=v(a);null==d&&z(a),d[0]+=b,d[1]+=c,a.setAttributeNS(null,"viewBox",d.join(" "))},y=function(a,b,c){let d=a.createSVGPoint();d.x=b,d.y=c;let e=d.matrixTransform(a.getScreenCTM().inverse()),f=[e.x,e.y];return f.x=e.x,f.y=e.y,f},z=function(a){let b=a.getBoundingClientRect(),c=0==b.width?640:b.width,d=0==b.height?480:b.height;u(a,0,0,c,d)},A="http://www.w3.org/2000/svg",B=function(){let a=document.createElementNS(A,"svg");return a.setAttribute("version","1.1"),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),U(a),a},C=function(a,b,c,d){let e=document.createElementNS(A,"line");return e.setAttributeNS(null,"x1",a),e.setAttributeNS(null,"y1",b),e.setAttributeNS(null,"x2",c),e.setAttributeNS(null,"y2",d),S(e),e},D=function(a,b,c){let d=document.createElementNS(A,"circle");return d.setAttributeNS(null,"cx",a),d.setAttributeNS(null,"cy",b),d.setAttributeNS(null,"r",c),S(d),d},E=function(a,b,c,d){let e=document.createElementNS(A,"ellipse");return e.setAttributeNS(null,"cx",a),e.setAttributeNS(null,"cy",b),e.setAttributeNS(null,"rx",c),e.setAttributeNS(null,"ry",d),S(e),e},F=function(a,b,c,d){let e=document.createElementNS(A,"rect");return e.setAttributeNS(null,"x",a),e.setAttributeNS(null,"y",b),e.setAttributeNS(null,"width",c),e.setAttributeNS(null,"height",d),S(e),e},G=function(a){let b=document.createElementNS(A,"polygon");return O(b,a),S(b),b},H=function(a){let b=document.createElementNS(A,"polyline");return O(b,a),S(b),b},I=function(a,b,c,d,e,f,g,h){let i=document.createElementNS(A,"path");return i.setAttributeNS(null,"d","M "+a+","+b+" C "+c+","+d+" "+e+","+f+" "+g+","+h),S(i),i},J=function(a,b,c){let d=document.createElementNS(A,"text");return d.innerHTML=a,d.setAttributeNS(null,"x",b),d.setAttributeNS(null,"y",c),S(d),d},K=function(a,b,c,d,e){let f=document.createElementNS(A,"path");return P(f,a,b,c,d,e,!0),S(f),f},L=function(a,b,c,d,e){let f=document.createElementNS(A,"path");return P(f,a,b,c,d,e,!1),S(f),f},M=function(){let a=document.createElementNS(A,"g");return S(a),R(a),a},N=function(b,c,a,d){var e=Math.PI;let f=.5*(2*e/d),j=h(f)*a,i=Array.from(Array(d)).map((k,l)=>{let i=-2*e*l/d+f,a=b+j*g(i),m=c+j*h(i);return[a,m]});return G(i)},O=function(a,b){if(null!=b&&b.constructor===Array){let c=b.map(a=>a.constructor===Array?a:[a.x,a.y]).reduce((a,b)=>a+b[0]+","+b[1]+" ","");a.setAttributeNS(null,"points",c)}},P=function(a,b,c,e,f,i,j=!1){let k=[b+h(f)*e,c+g(f)*e],l=[h(f)*e,g(f)*e],m=[h(i)*e,g(i)*e],n=[m[0]-l[0],m[1]-l[1]],o=l[0]*m[1]-l[1]*m[0],p=l[0]*m[0]+l[1]*m[1],q=0<Math.atan2(o,p)?0:1,r=j?"M "+b+","+c+" l "+l[0]+","+l[1]+" ":"M "+k[0]+","+k[1]+" ";r+=["a ",e,e,0,q,1,n[0],n[1]].join(" "),j&&(r+=" Z"),a.setAttributeNS(null,"d",r)},Q={line:C,circle:D,ellipse:E,rect:F,polygon:G,polyline:H,bezier:I,text:J,wedge:K,arc:L,regularPolygon:N,group:M},R=function(a){Object.keys(Q).forEach(b=>{a[b]=function(){let c=Q[b](...arguments);return a.appendChild(c),c}})},S=function(a){a.removeChildren=function(){return j(a)},a.addClass=function(){return n(a,...arguments)},a.removeClass=function(){return o(a,...arguments)},a.setClass=function(){return p(a,...arguments)},a.setID=function(){return q(a,...arguments)}},T=function(a){a.setViewBox=function(){return u(a,...arguments)},a.getViewBox=function(){return v(a,...arguments)},a.scaleViewBox=function(){return w(a,...arguments)},a.translateViewBox=function(){return x(a,...arguments)},a.convertToViewBox=function(){return y(a,...arguments)}},U=function(a){S(a),R(a),T(a)},V={begin:"onMouseDown",enter:"onMouseEnter",leave:"onMouseLeave",move:"onMouseMove",end:"onMouseUp",scroll:"onScroll"},W=function(a){let b=a,c=Object.create(null);Object.assign(c,{isPressed:!1,position:[0,0],pressed:[0,0],drag:[0,0],prev:[0,0],x:0,y:0});const d=function(a,d){c.position=y(b,a,d),c.x=c.position[0],c.y=c.position[1]},e=function(){c.isPressed=!0,c.pressed=y(b,event.clientX,event.clientY),d(event.clientX,event.clientY)},f=function(){c.drag=[c.position[0]-c.pressed[0],c.position[1]-c.pressed[1]],c.drag.x=c.drag[0],c.drag.y=c.drag[1]};let g={};return Object.defineProperty(g,"getPointer",{value:function(){let a=c.position.slice();return Object.keys(c).filter(a=>"object"==typeof a).forEach(b=>a[b]=c[b].slice()),Object.keys(c).filter(a=>"object"!=typeof a).forEach(b=>a[b]=c[b]),Object.freeze(a)}}),Object.defineProperty(g,"didMove",{value:function(a,b){c.prev=c.position,d(a,b),c.isPressed&&f()}}),Object.defineProperty(g,"didPress",{value:e}),Object.defineProperty(g,"didRelease",{value:function(){c.isPressed=!1,d(event.clientX,event.clientY)}}),Object.defineProperty(g,"node",{set:function(a){b=a}}),g},X=function(a){let b=a.filter(a=>a instanceof HTMLElement).shift(),c=a.filter(b=>"string"==typeof b||b instanceof String).map(a=>document.getElementById(a)).shift();return null==b?null==c?document.body:c:b},Y=function(a,b){let c=b.filter(a=>!isNaN(a));if(2<=c.length)a.setAttributeNS(null,"width",c[0]),a.setAttributeNS(null,"height",c[1]),u(a,0,0,c[0],c[1]);else if(null==a.getAttribute("viewBox")){let b=a.getBoundingClientRect();u(a,0,0,b.width,b.height)}},Z=function(a){Object.defineProperty(a,"w",{get:function(){return k(a)},set:function(b){a.setAttributeNS(null,"width",b)}}),Object.defineProperty(a,"h",{get:function(){return l(a)},set:function(b){a.setAttributeNS(null,"height",b)}}),a.getWidth=function(){return k(a)},a.getHeight=function(){return l(a)},a.setWidth=function(b){a.setAttributeNS(null,"width",b)},a.setHeight=function(b){a.setAttributeNS(null,"height",b)},a.save=function(b="image.svg"){return r(a,b)},a.load=function(b,c){t(b,function(b,d){let e=a.parentNode;null!=b&&(b.events=a.events,U(b),null==b.events?b.events=f(b):b.events.setup(b),Z(b),a.remove(),a=b),null!=e&&e.appendChild(a),null!=c&&c(a,d)})}},$=function(a,b){null==b&&(b={}),null==b.radius&&(b.radius=1),null==b.fill&&(b.fill="#000000"),null==b.position&&(b.position=[0,0]);let d=D(0,0,b.radius);d.setAttribute("fill",b.fill);let c=b.position.slice(),e=!1;null!=a&&a.appendChild(d);const f=function(a,b){c[0]=a,c[1]=b,d.setAttribute("cx",a),d.setAttribute("cy",b)},g=function(a){if(e){let b=h(a);f(b[0],b[1])}};let h=function(a){return a};return{circle:d,set position(a){null==a[0]?null!=a.x&&f(a.x,a.y):f(a[0],a[1])},get position(){return[...c]},onMouseUp:function(){e=!1},onMouseMove:g,distance:function(a){var b=Math.pow;return Math.sqrt(b(a[0]-c[0],2)+b(a[1]-c[1],2))},set positionDidUpdate(a){h=a},set selected(a){e=!0}}};a.svg=B,a.line=C,a.circle=D,a.ellipse=E,a.rect=F,a.polygon=G,a.polyline=H,a.bezier=I,a.text=J,a.wedge=K,a.arc=L,a.group=M,a.regularPolygon=N,a.setPoints=O,a.setArc=P,a.setViewBox=u,a.getViewBox=v,a.scaleViewBox=w,a.translateViewBox=x,a.convertToViewBox=y,a.removeChildren=j,a.save=r,a.load=t,a.image=function(){let a=B(),b=Array.from(arguments);Y(a,b),Z(a),a.events=f(a);const c=function(){Y(a,b),X(b).appendChild(a),b.filter(a=>"function"==typeof a).forEach(a=>a())};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c(),a},a.controls=function(a,b=1,c){null==c&&(c={}),null==c.parent&&(c.parent=a),null==c.radius&&(c.radius=1),null==c.fill&&(c.fill="#000000");let d,e=Array.from(Array(b)).map(()=>$(c.parent,c));const f=function(b){let c=y(a,b.clientX,b.clientY);0<e.length&&(d=e.map((a,b)=>({i:b,d:a.distance(c)})).sort((c,a)=>c.d-a.d).shift().i,e[d].selected=!0)};return a.addEventListener("mousedown",f),a.addEventListener("mouseup",function(b){let c=y(a,b.clientX,b.clientY);e.forEach(a=>a.onMouseUp(c)),d=void 0}),a.addEventListener("mousemove",function(b){let c=y(a,b.clientX,b.clientY);e.forEach(a=>a.onMouseMove(c))}),Object.defineProperty(e,"selectedIndex",{get:function(){return d}}),Object.defineProperty(e,"selected",{get:function(){return e[d]}}),Object.defineProperty(e,"removeAll",{value:function(){e.forEach(a=>a.remove())}}),e},Object.defineProperty(a,"__esModule",{value:!0})});
